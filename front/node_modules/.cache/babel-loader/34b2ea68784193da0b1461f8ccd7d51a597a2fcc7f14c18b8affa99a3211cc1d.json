{"ast":null,"code":"var _jsxFileName = \"/home/noir/projects/diplom2/front/src/components/MainNotify.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { getSocket } from \"../socket\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction MainNotify() {\n  _s();\n  const [notifications, setNotifications] = useState([]);\n  useEffect(() => {\n    const socket = getSocket();\n    if (!socket) {\n      console.log(\"Socket не инициализирован\");\n      return;\n    }\n    ;\n    const handleNotification = msg => {\n      console.log(\"Получено уведомление:\", msg);\n      setNotifications(prev => [...prev, msg]);\n    };\n    socket.on(\"notification\", handleNotification);\n    return () => {\n      socket.off(\"notification\", handleNotification);\n    };\n  }, []);\n  const notifyOrgAdmin = async () => {\n    // Отправляем HTTP-запрос на сервер, чтобы он отправил уведомление orgadmin\n    await fetch(\"http://localhost:5000/notify\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        username: \"orgadmin\",\n        message: \"Тестовое уведомление\"\n      })\n    });\n  };\n  const fetchAllNotify = async () => {\n    const userInfo = JSON.parse(localStorage.getItem(\"user\"));\n    await fetch(\"http://localhost:5000/notify\", {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        username: userInfo.username,\n        message: \"Поиск уведомлений\"\n      })\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: notifyOrgAdmin,\n      children: \"\\u0423\\u0432\\u0435\\u0434\\u043E\\u043C\\u0438\\u0442\\u044C \\u043E\\u0440\\u0433\\u0430\\u0434\\u043C\\u0438\\u043D\\u0430\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"\\u0423\\u0432\\u0435\\u0434\\u043E\\u043C\\u043B\\u0435\\u043D\\u0438\\u044F:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: notifications.map((msg, idx) => /*#__PURE__*/_jsxDEV(\"li\", {\n        children: msg\n      }, idx, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 9\n  }, this);\n}\n_s(MainNotify, \"6gMUc0OfbF4zJu51/S5RmKCczuA=\");\n_c = MainNotify;\nexport default MainNotify;\nvar _c;\n$RefreshReg$(_c, \"MainNotify\");","map":{"version":3,"names":["React","useEffect","useState","getSocket","jsxDEV","_jsxDEV","MainNotify","_s","notifications","setNotifications","socket","console","log","handleNotification","msg","prev","on","off","notifyOrgAdmin","fetch","method","headers","body","JSON","stringify","username","message","fetchAllNotify","userInfo","parse","localStorage","getItem","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","map","idx","_c","$RefreshReg$"],"sources":["/home/noir/projects/diplom2/front/src/components/MainNotify.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { getSocket } from \"../socket\";\n\nfunction MainNotify() {\n    const [notifications, setNotifications] = useState([]);\n\n    useEffect(() => {\n        const socket = getSocket();\n\n\n        if (!socket) {\n            console.log(\"Socket не инициализирован\");\n            return\n\n        };\n\n        const handleNotification = (msg) => {\n            console.log(\"Получено уведомление:\", msg);\n            setNotifications((prev) => [...prev, msg]);\n        };\n\n        socket.on(\"notification\", handleNotification);\n\n        return () => {\n            socket.off(\"notification\", handleNotification);\n        };\n    }, []);\n\n    const notifyOrgAdmin = async () => {\n        // Отправляем HTTP-запрос на сервер, чтобы он отправил уведомление orgadmin\n        await fetch(\"http://localhost:5000/notify\", {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify({ username: \"orgadmin\", message: \"Тестовое уведомление\" }),\n        });\n    };\n    const fetchAllNotify = async () => {\n        const userInfo = JSON.parse(localStorage.getItem(\"user\"));\n        await fetch(\"http://localhost:5000/notify\",{\n            method: \"GET\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify({ username: userInfo.username, message: \"Поиск уведомлений\" })\n\n        });\n    };\n\n    return (\n        <div>\n        <button onClick={notifyOrgAdmin}>Уведомить оргадмина</button>\n        <h3>Уведомления:</h3>\n        <ul>\n        {notifications.map((msg, idx) => (\n            <li key={idx}>{msg}</li>\n        ))}\n        </ul>\n        </div>\n    );\n}\n\nexport default MainNotify;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,SAAS,QAAQ,WAAW;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEtC,SAASC,UAAUA,CAAA,EAAG;EAAAC,EAAA;EAClB,MAAM,CAACC,aAAa,EAAEC,gBAAgB,CAAC,GAAGP,QAAQ,CAAC,EAAE,CAAC;EAEtDD,SAAS,CAAC,MAAM;IACZ,MAAMS,MAAM,GAAGP,SAAS,CAAC,CAAC;IAG1B,IAAI,CAACO,MAAM,EAAE;MACTC,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAC;MACxC;IAEJ;IAAC;IAED,MAAMC,kBAAkB,GAAIC,GAAG,IAAK;MAChCH,OAAO,CAACC,GAAG,CAAC,uBAAuB,EAAEE,GAAG,CAAC;MACzCL,gBAAgB,CAAEM,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAED,GAAG,CAAC,CAAC;IAC9C,CAAC;IAEDJ,MAAM,CAACM,EAAE,CAAC,cAAc,EAAEH,kBAAkB,CAAC;IAE7C,OAAO,MAAM;MACTH,MAAM,CAACO,GAAG,CAAC,cAAc,EAAEJ,kBAAkB,CAAC;IAClD,CAAC;EACL,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMK,cAAc,GAAG,MAAAA,CAAA,KAAY;IAC/B;IACA,MAAMC,KAAK,CAAC,8BAA8B,EAAE;MACxCC,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QAAE,cAAc,EAAE;MAAmB,CAAC;MAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;QAAEC,QAAQ,EAAE,UAAU;QAAEC,OAAO,EAAE;MAAuB,CAAC;IAClF,CAAC,CAAC;EACN,CAAC;EACD,MAAMC,cAAc,GAAG,MAAAA,CAAA,KAAY;IAC/B,MAAMC,QAAQ,GAAGL,IAAI,CAACM,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC;IACzD,MAAMZ,KAAK,CAAC,8BAA8B,EAAC;MACvCC,MAAM,EAAE,KAAK;MACbC,OAAO,EAAE;QAAE,cAAc,EAAE;MAAmB,CAAC;MAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;QAAEC,QAAQ,EAAEG,QAAQ,CAACH,QAAQ;QAAEC,OAAO,EAAE;MAAoB,CAAC;IAEtF,CAAC,CAAC;EACN,CAAC;EAED,oBACIrB,OAAA;IAAA2B,QAAA,gBACA3B,OAAA;MAAQ4B,OAAO,EAAEf,cAAe;MAAAc,QAAA,EAAC;IAAmB;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,eAC7DhC,OAAA;MAAA2B,QAAA,EAAI;IAAY;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eACrBhC,OAAA;MAAA2B,QAAA,EACCxB,aAAa,CAAC8B,GAAG,CAAC,CAACxB,GAAG,EAAEyB,GAAG,kBACxBlC,OAAA;QAAA2B,QAAA,EAAelB;MAAG,GAATyB,GAAG;QAAAL,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAW,CAC1B;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACA,CAAC;AAEd;AAAC9B,EAAA,CAtDQD,UAAU;AAAAkC,EAAA,GAAVlC,UAAU;AAwDnB,eAAeA,UAAU;AAAC,IAAAkC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}