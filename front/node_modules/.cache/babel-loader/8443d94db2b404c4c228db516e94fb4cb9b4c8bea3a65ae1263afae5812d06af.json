{"ast":null,"code":"// import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nconst API_URL_STRUCT = \"http://127.0.0.1:5000/api/get_struct\";\nconst API_URL_SINGLE = \"http://127.0.0.1:5000/api/edit_reference\";\nconst API_URL_SINGLE_MULTIFILTERS = \"http://127.0.0.1:5000/api/get_single_with_mf\";\n\n// const fetchModelSchema = ... TODO\n\n/**\n * Универсальная функция для получения данных структуры из API.\n * @param {string} structName - Имя структуры для запроса.\n * @param {object} filters - Объект с фильтрами для запроса (ключ: значение).\n * @param {string} token - JWT токен для авторизации (опционально).\n * @returns {Promise<object>} - Промис, разрешающийся в данные структуры или отклоняющийся с ошибкой.\n */\nconst fetchStructureData = async (structName, filters = {}, token = null) => {\n  try {\n    const params = {\n      struct_name: structName,\n      ...Object.entries(filters).reduce((acc, [key, value]) => {\n        acc[`filter_k`] = key;\n        acc[`filter_v`] = value;\n        return acc;\n      }, {})\n    };\n    const token = localStorage.getItem('jwtToken');\n    const headers = token ? {\n      'tokenJWTAuthorization': token\n    } : {};\n    const response = await axios.get(API_URL_STRUCT, {\n      params: params,\n      headers: headers,\n      withCredentials: true\n    });\n    if (response.status >= 400) {\n      throw new Error(`HTTP error! Status: ${response.status}`);\n    }\n    const data = response.data;\n    console.log(JSON.stringify(data, null, 4));\n    if (data.status !== \"success\") {\n      throw new Error(`API Error: ${data.error}`);\n    }\n    console.log(\"Данные успешно получены:\");\n    return data;\n  } catch (error) {\n    console.error(\"Ошибка при получении структуры:\", error);\n    console.log(\"Структура была:\", structName);\n    throw error; // Пробрасываем ошибку дальше\n  }\n};\nconst fetchSingleTableDataWithFilters = async (tableName, filters) => {\n  try {\n    const token = localStorage.getItem('jwtToken');\n    console.log(tableName);\n    const headers = token ? {\n      'tokenJWTAuthorization': token\n    } : {};\n\n    // Преобразуем объект фильтров в параметры запроса\n    const params = {\n      reference_select: tableName,\n      ...filters\n    };\n    const response = await axios.get(API_URL_SINGLE_MULTIFILTERS, {\n      headers: headers,\n      params: params,\n      withCredentials: true\n    });\n    if (response.status >= 400) {\n      console.log(\"Ошибка HTTP: \", response);\n      return null;\n    }\n    const data = response.data;\n    const records = data.new_content;\n    console.log(\" --> Сейчас будет - \", data.selected_reference);\n    console.log(records);\n    if (!records || records.length === 0) {\n      console.log(\"Нет записей в таблице\");\n      return null;\n    }\n    return records;\n  } catch (error) {\n    console.log(\"Ошибка при получении данных таблицы:\", error.message);\n    return null;\n  }\n};\nconst fetchSingleTableData = async tableName => {\n  try {\n    const token = localStorage.getItem('jwtToken');\n    console.log(tableName);\n    const headers = token ? {\n      'tokenJWTAuthorization': token\n    } : {};\n    const response = await axios.get(API_URL_SINGLE, {\n      headers: headers,\n      params: {\n        reference_select: tableName\n      },\n      withCredentials: true\n    });\n    // console.log(response);\n\n    if (response.status >= 400) {\n      console.log(\"Ошибка HTTP: \", response);\n      return null;\n    }\n    const data = response.data;\n    const records = data.new_content;\n    console.log(\" --> Сейчас будет - \", data.selected_reference);\n    console.log(records);\n    if (!records || records.length === 0) {\n      console.log(\"Нет записей в таблице\");\n      return null;\n    }\n    return records;\n  } catch (error) {\n    console.log(\"Ошибка при получении данных таблицы:\", error.message);\n    return null;\n  }\n};\nexport { fetchStructureData, fetchSingleTableData, fetchSingleTableDataWithFilters };","map":{"version":3,"names":["axios","API_URL_STRUCT","API_URL_SINGLE","API_URL_SINGLE_MULTIFILTERS","fetchStructureData","structName","filters","token","params","struct_name","Object","entries","reduce","acc","key","value","localStorage","getItem","headers","response","get","withCredentials","status","Error","data","console","log","JSON","stringify","error","fetchSingleTableDataWithFilters","tableName","reference_select","records","new_content","selected_reference","length","message","fetchSingleTableData"],"sources":["/home/noir/projects/diplom/front/src/api/fetch_records.js"],"sourcesContent":["// import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nconst API_URL_STRUCT = \"http://127.0.0.1:5000/api/get_struct\";\nconst API_URL_SINGLE = \"http://127.0.0.1:5000/api/edit_reference\";\nconst API_URL_SINGLE_MULTIFILTERS = \"http://127.0.0.1:5000/api/get_single_with_mf\";\n\n// const fetchModelSchema = ... TODO\n\n/**\n * Универсальная функция для получения данных структуры из API.\n * @param {string} structName - Имя структуры для запроса.\n * @param {object} filters - Объект с фильтрами для запроса (ключ: значение).\n * @param {string} token - JWT токен для авторизации (опционально).\n * @returns {Promise<object>} - Промис, разрешающийся в данные структуры или отклоняющийся с ошибкой.\n */\nconst fetchStructureData = async (structName, filters = {}, token = null) => {\n    try {\n        const params = {\n            struct_name: structName,\n            ...Object.entries(filters).reduce((acc, [key, value]) => {\n                acc[`filter_k`] = key;\n                acc[`filter_v`] = value;\n                return acc;\n            }, {})\n        };\n        const token = localStorage.getItem('jwtToken');\n        const headers = token ? { 'tokenJWTAuthorization': token } : {};\n\n        const response = await axios.get(API_URL_STRUCT, {\n            params: params,\n            headers: headers,\n            withCredentials: true\n        });\n\n        if (response.status >= 400) {\n            throw new Error(`HTTP error! Status: ${response.status}`);\n        }\n\n        const data = response.data;\n\n        console.log(JSON.stringify(data, null, 4));\n\n        if (data.status !== \"success\") {\n            throw new Error(`API Error: ${data.error}`);\n        }\n\n        console.log(\"Данные успешно получены:\");\n\n        return data;\n    } catch (error) {\n        console.error(\"Ошибка при получении структуры:\", error);\n        console.log(\"Структура была:\", structName);\n        throw error; // Пробрасываем ошибку дальше\n    }\n};\n\nconst fetchSingleTableDataWithFilters = async (tableName, filters) => {\n    try {\n        const token = localStorage.getItem('jwtToken');\n        console.log(tableName);\n        const headers = token ? { 'tokenJWTAuthorization': token } : {};\n\n        // Преобразуем объект фильтров в параметры запроса\n        const params = {\n            reference_select: tableName,\n            ...filters\n        };\n\n        const response = await axios.get(API_URL_SINGLE_MULTIFILTERS, {\n            headers: headers,\n            params: params,\n            withCredentials: true\n        });\n\n        if (response.status >= 400) {\n            console.log(\"Ошибка HTTP: \", response);\n            return null;\n        }\n\n        const data = response.data;\n        const records = data.new_content;\n\n        console.log(\" --> Сейчас будет - \", data.selected_reference)\n        console.log(records);\n\n        if (!records || records.length === 0) {\n            console.log(\"Нет записей в таблице\");\n            return null;\n        }\n\n        return records;\n    } catch (error) {\n        console.log(\"Ошибка при получении данных таблицы:\", error.message);\n        return null;\n    }\n};\n\n\nconst fetchSingleTableData = async (tableName) => {\n    try {\n        const token = localStorage.getItem('jwtToken');\n        console.log(tableName);\n        const headers = token ? { 'tokenJWTAuthorization': token } : {};\n        const response = await axios.get(API_URL_SINGLE, {\n            headers: headers,\n            params: { reference_select: tableName },\n            withCredentials: true\n        });\n        // console.log(response);\n\n        if (response.status >= 400) {\n            console.log(\"Ошибка HTTP: \", response);\n            return null;\n        }\n\n        const data = response.data;\n        const records = data.new_content;\n\n        console.log(\" --> Сейчас будет - \", data.selected_reference)\n        console.log(records);\n\n        if (!records || records.length === 0) {\n            console.log(\"Нет записей в таблице\");\n            return null;\n        }\n\n        return records;\n    } catch (error) {\n        console.log(\"Ошибка при получении данных таблицы:\", error.message);\n        return null;\n    }\n};\n\nexport {fetchStructureData, fetchSingleTableData, fetchSingleTableDataWithFilters};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}