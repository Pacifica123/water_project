{"ast":null,"code":"var _jsxFileName = \"/home/noir/projects/diplom/front/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport \"./App.css\";\nimport LoginPage from \"./components/LoginPage\";\nimport ProtectedContent from \"./components/ProtectedContent\";\nimport axios from \"axios\";\nimport { NotificationProvider } from \"./components/NotificationContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n\n  // Создаем экземпляр axios\n  const axiosInstance = axios.create({\n    baseURL: \"http://127.0.0.1:5000/api\"\n  });\n\n  // Интерцепторы запросов (добавление токена)\n  axiosInstance.interceptors.request.use(config => {\n    const token = localStorage.getItem(\"jwtToken\");\n    if (token) {\n      config.headers.Authorization = 'Bearer ${token}';\n    }\n    return config;\n  }, error => Promise.reject(error));\n\n  // Интерцепторы ответов (обработка 401)\n  useEffect(() => {\n    const interceptor = axiosInstance.interceptors.response.use(response => response, error => {\n      if (error.response && error.response.status === 401) {\n        handleLogout();\n      }\n      return Promise.reject(error);\n    });\n    return () => {\n      axiosInstance.interceptors.response.eject(interceptor);\n    };\n  }, []);\n\n  // Проверка токена при загрузке\n  useEffect(() => {\n    const token = localStorage.getItem(\"jwtToken\");\n    if (token) {\n      setIsAuthenticated(true);\n    }\n  }, []);\n  const handleLogin = () => {\n    setIsAuthenticated(true);\n  };\n  const handleLogout = () => {\n    console.log(\"Выход из системы\");\n    localStorage.clear();\n    setIsAuthenticated(false);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app\",\n    children: /*#__PURE__*/_jsxDEV(NotificationProvider, {\n      children: isAuthenticated ? /*#__PURE__*/_jsxDEV(ProtectedContent, {\n        onLogout: handleLogout,\n        axios: axiosInstance\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 7\n      }, this) : /*#__PURE__*/_jsxDEV(LoginPage, {\n        onLogin: handleLogin,\n        axios: axiosInstance\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"AWDL5NLZvTfssO0fqd6MEOWxzBo=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","LoginPage","ProtectedContent","axios","NotificationProvider","jsxDEV","_jsxDEV","App","_s","isAuthenticated","setIsAuthenticated","axiosInstance","create","baseURL","interceptors","request","use","config","token","localStorage","getItem","headers","Authorization","error","Promise","reject","interceptor","response","status","handleLogout","eject","handleLogin","console","log","clear","className","children","onLogout","fileName","_jsxFileName","lineNumber","columnNumber","onLogin","_c","$RefreshReg$"],"sources":["/home/noir/projects/diplom/front/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport \"./App.css\";\nimport LoginPage from \"./components/LoginPage\";\nimport ProtectedContent from \"./components/ProtectedContent\";\nimport axios from \"axios\";\nimport { NotificationProvider } from \"./components/NotificationContext\";\n\nfunction App() {\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n\n  // Создаем экземпляр axios\n  const axiosInstance = axios.create({\n    baseURL: \"http://127.0.0.1:5000/api\",\n  });\n\n  // Интерцепторы запросов (добавление токена)\n  axiosInstance.interceptors.request.use(\n    (config) => {\n      const token = localStorage.getItem(\"jwtToken\");\n      if (token) {\n        config.headers.Authorization = 'Bearer ${token}';\n      }\n      return config;\n    },\n    (error) => Promise.reject(error)\n  );\n\n  // Интерцепторы ответов (обработка 401)\n  useEffect(() => {\n    const interceptor = axiosInstance.interceptors.response.use(\n      (response) => response,\n                                                                (error) => {\n                                                                  if (error.response && error.response.status === 401) {\n                                                                    handleLogout();\n                                                                  }\n                                                                  return Promise.reject(error);\n                                                                }\n    );\n\n    return () => {\n      axiosInstance.interceptors.response.eject(interceptor);\n    };\n  }, []);\n\n  // Проверка токена при загрузке\n  useEffect(() => {\n    const token = localStorage.getItem(\"jwtToken\");\n    if (token) {\n      setIsAuthenticated(true);\n    }\n  }, []);\n\n  const handleLogin = () => {\n    setIsAuthenticated(true);\n  };\n\n  const handleLogout = () => {\n    console.log(\"Выход из системы\");\n    localStorage.clear();\n    setIsAuthenticated(false);\n  };\n\n  return (\n    <div className=\"app\">\n    <NotificationProvider>\n    {isAuthenticated ? (\n      <ProtectedContent onLogout={handleLogout} axios={axiosInstance} />\n    ) : (\n      <LoginPage onLogin={handleLogin} axios={axiosInstance} />\n    )}\n    </NotificationProvider>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,OAAO,WAAW;AAClB,OAAOC,SAAS,MAAM,wBAAwB;AAC9C,OAAOC,gBAAgB,MAAM,+BAA+B;AAC5D,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,oBAAoB,QAAQ,kCAAkC;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExE,SAASC,GAAGA,CAAA,EAAG;EAAAC,EAAA;EACb,MAAM,CAACC,eAAe,EAAEC,kBAAkB,CAAC,GAAGX,QAAQ,CAAC,KAAK,CAAC;;EAE7D;EACA,MAAMY,aAAa,GAAGR,KAAK,CAACS,MAAM,CAAC;IACjCC,OAAO,EAAE;EACX,CAAC,CAAC;;EAEF;EACAF,aAAa,CAACG,YAAY,CAACC,OAAO,CAACC,GAAG,CACnCC,MAAM,IAAK;IACV,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC;IAC9C,IAAIF,KAAK,EAAE;MACTD,MAAM,CAACI,OAAO,CAACC,aAAa,GAAG,iBAAiB;IAClD;IACA,OAAOL,MAAM;EACf,CAAC,EACAM,KAAK,IAAKC,OAAO,CAACC,MAAM,CAACF,KAAK,CACjC,CAAC;;EAED;EACAvB,SAAS,CAAC,MAAM;IACd,MAAM0B,WAAW,GAAGf,aAAa,CAACG,YAAY,CAACa,QAAQ,CAACX,GAAG,CACxDW,QAAQ,IAAKA,QAAQ,EACqCJ,KAAK,IAAK;MACT,IAAIA,KAAK,CAACI,QAAQ,IAAIJ,KAAK,CAACI,QAAQ,CAACC,MAAM,KAAK,GAAG,EAAE;QACnDC,YAAY,CAAC,CAAC;MAChB;MACA,OAAOL,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;IAC9B,CAC5D,CAAC;IAED,OAAO,MAAM;MACXZ,aAAa,CAACG,YAAY,CAACa,QAAQ,CAACG,KAAK,CAACJ,WAAW,CAAC;IACxD,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA1B,SAAS,CAAC,MAAM;IACd,MAAMkB,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC;IAC9C,IAAIF,KAAK,EAAE;MACTR,kBAAkB,CAAC,IAAI,CAAC;IAC1B;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMqB,WAAW,GAAGA,CAAA,KAAM;IACxBrB,kBAAkB,CAAC,IAAI,CAAC;EAC1B,CAAC;EAED,MAAMmB,YAAY,GAAGA,CAAA,KAAM;IACzBG,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC;IAC/Bd,YAAY,CAACe,KAAK,CAAC,CAAC;IACpBxB,kBAAkB,CAAC,KAAK,CAAC;EAC3B,CAAC;EAED,oBACEJ,OAAA;IAAK6B,SAAS,EAAC,KAAK;IAAAC,QAAA,eACpB9B,OAAA,CAACF,oBAAoB;MAAAgC,QAAA,EACpB3B,eAAe,gBACdH,OAAA,CAACJ,gBAAgB;QAACmC,QAAQ,EAAER,YAAa;QAAC1B,KAAK,EAAEQ;MAAc;QAAA2B,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,gBAElEnC,OAAA,CAACL,SAAS;QAACyC,OAAO,EAAEX,WAAY;QAAC5B,KAAK,EAAEQ;MAAc;QAAA2B,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE;IACzD;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACqB;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAClB,CAAC;AAEV;AAACjC,EAAA,CAlEQD,GAAG;AAAAoC,EAAA,GAAHpC,GAAG;AAoEZ,eAAeA,GAAG;AAAC,IAAAoC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}